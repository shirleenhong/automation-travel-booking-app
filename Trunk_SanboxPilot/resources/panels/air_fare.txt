*** Settings ***
Documentation     This resource file covers all reusable actions for Air Fare Related test cases
Variables         ../variables/air_fare.py
Resource          ../common/core.txt
Resource          ../../acceptance_tests/air_fare/air_fare_verification.txt

*** Keywords ***
Click Add Alternate Fare
    Auto It Set Option    MouseCoordMode    2
    Mouse Click    LEFT    921    460    1
    Auto It Set Option    MouseCoordMode    0
    Sleep    5
    [Teardown]    Take Screenshot

Click Add Cancellation Button
    [Arguments]    ${changes_code}    ${fare_tab}=Fare 1    ${field_instance}=${EMPTY}    ${default_control_counter}=True
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    btnAddCancellations_${fare_tab_index},btnAddCancellations_alt_${fare_tab_index}    ${default_control_counter}    ${field_instance}
    Click Control Button    ${object_name}

Click Add Changes Button
    [Arguments]    ${changes_code}    ${fare_tab}=Fare 1    ${field_instance}=${EMPTY}    ${default_control_counter}=True
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    btnAddChanges_${fare_tab_index},btnAddChanges_alt_${fare_tab_index}    ${default_control_counter}    ${field_instance}
    Click Control Button    ${object_name}

Click Add Manual Fare
    [Arguments]    ${current_active_tab}
    Click Button In Air Fare    ${current_active_tab}    Add Manual Fare
    [Teardown]    Take Screenshot

Click Copy Air Fare
    Sleep    2
    ${copy_offers}    Determine Multiple Object Name Based On Active Tab    btnCopyOffers
    Comment    ${fare_routing}    Determine Multiple Object Name Based On Active Tab    cmtxtRouting
    Click Control Button    ${copy_offers}
    Comment    Wait Until Control Object Is Visible    ${fare_routing}
    [Teardown]    Take Screenshot

Click Copy Alternate Fare
    Sleep    2
    ${copy_offers}    Determine Multiple Object Name Based On Active Tab    btnCopyOffers_alt
    ${alternate_routing}    Determine Multiple Object Name Based On Active Tab    cmtxtRouting_alt
    Click Control Button    ${copy_offers}
    Wait Until Control Object Is Visible    ${alternate_routing}
    [Teardown]    Take Screenshot

Click Details Tab
    Auto It Set Option    MouseCoordMode    2
    Mouse Click    LEFT    488    488    1
    Auto It Set Option    MouseCoordMode    0
    Sleep    5
    [Teardown]    Take Screenshot

Click Fare Tab
    [Arguments]    ${fare_tab_value}
    Click Control Button    [NAME:TabControl1]
    Verify Fare Tab Is Visible    ${fare_tab_value}
    Select Tab Control    ${fare_tab_value}
    ${fare_tab_index} =    Fetch From Right    ${fare_tab_value}    ${SPACE}
    Set Test Variable    ${fare_tab_index}
    Sleep    2
    [Teardown]    Take Screenshot

Click Pricing Extras Tab
    Auto It Set Option    MouseCoordMode    2
    Mouse Click    LEFT    488    583    1
    Auto It Set Option    MouseCoordMode    0
    Sleep    5
    [Teardown]    Take Screenshot

Click Remove Alternate Fare
    Auto It Set Option    MouseCoordMode    2
    Mouse Click    LEFT    921    653    1
    Auto It Set Option    MouseCoordMode    0
    Sleep    5
    [Teardown]    Take Screenshot

Click Remove Cancellation Button
    [Arguments]    ${changes_code}    ${fare_tab}=Fare 1    ${field_instance}=${EMPTY}    ${default_control_counter}=True
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    btnRemoveCancellations_${fare_tab_index},btnRemoveCancellations_alt_${fare_tab_index}    ${default_control_counter}    ${field_instance}
    Click Control Button    ${object_name}

Click Remove Changes Button
    [Arguments]    ${changes_code}    ${fare_tab}=Fare 1    ${field_instance}=${EMPTY}    ${default_control_counter}=True
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    btnRemoveChanges_${fare_tab_index},btnRemoveChanges_alt_${fare_tab_index}    ${default_control_counter}    ${field_instance}
    Click Control Button    ${object_name}

Compute High Fare And Low Fare For Ticketing Remarks
    ${index}    Set Variable If    '${fare_tab_index}' != '${EMPTY}'    ${fare_tab_index}    1
    Get High Fare Value
    Get Low Fare Value
    ${rounded_high_fare}    Evaluate    round(${converted_high_fare})
    ${rounded_low_fare}    Evaluate    round(${converted_low_fare})
    ${rounded_high_fare}    Convert To String    ${rounded_high_fare}
    ${rounded_low_fare}    Convert To String    ${rounded_low_fare}
    ${rounded_high_fare}    Fetch From Left    ${rounded_high_fare}    .
    ${rounded_low_fare}    Fetch From Left    ${rounded_low_fare}    .
    Set Test Variable    ${high_fare_${index}}    ${rounded_high_fare}
    Set Test Variable    ${low_fare_${index}}    ${rounded_low_fare}

Compute Transaction Fee
    [Arguments]    ${fare_number}    ${transaction_fee_percentage}
    Get Base Fare And Tax From Galileo For Fare X Tab    ${fare_number}
    ${transaction_fee_percentage}    Get Percentage Value    ${transaction_fee_percentage}
    Get Commission Rebate Amount Value    ${fare_number}
    ${base_fare_less_commission_amount}    Evaluate    ${base_fare_value_${fare_number}} - ${commission_rebate_value_${fare_number}}
    ${transaction_fee_amount}    Evaluate    ${base_fare_less_commission_amount} * ${transaction_fee_percentage}
    ${transaction_fee_amount}    Convert To Float    ${transaction_fee_amount}    2
    [Return]    ${transaction_fee_amount}

Create New Booking For Traveldoo With One Way Flight Using Default Values
    [Arguments]    ${client}    ${surname}    ${firstname}    ${city_pair}    ${client_account}=${EMPTY}    @{exclude_panels}
    Create New Booking With One Way Flight Using Default Values    ${client}    ${surname}    ${firstname}    ${city_pair}    ${client_account}=${EMPTY}    @{exclude_panels}
    Click Finish PNR
    Should Be True    '${current_pnr}' != '${EMPTY}'

Create New Booking With Circle Trip Air Flight Using Default Values
    [Arguments]    ${client}    ${surname}    ${firstname}    ${city_pair_1}    ${seat_select_1}    ${store_fare_1}
    ...    ${city_pair_2}    ${seat_select_2}    ${store_fare_2}    ${city_pair_3}    ${seat_select_3}    ${store_fare_3}
    ...    ${car_itinerary}    ${hotel_itinerary}    ${select_hotel}    ${select_rate}    ${store_hotel_rate}    @{exclude_panels}
    Set Client And Traveler    ${client}    ${surname}    ${firstname}
    Click New Booking
    Update PNR for EN or GB
    Book Flight X Months From Now    ${city_pair_1}    ${seat_select_1}    ${store_fare_1}    6
    Book Flight X Months From Now    ${city_pair_2}    ${seat_select_2}    ${store_fare_2}    6    2
    Book Flight X Months From Now    ${city_pair_3}    ${seat_select_3}    ${store_fare_3}    6    4
    Click Read Booking
    Populate All Panels (Except Given Panels If Any)    @{exclude_panels}

Create New Booking With Circle Trip Flight Cars And Hotel
    [Arguments]    ${client}    ${surname}    ${firstname}    ${city_pair_1}    ${seat_select_1}    ${store_fare_1}
    ...    ${city_pair_2}    ${seat_select_2}    ${store_fare_2}    ${city_pair_3}    ${seat_select_3}    ${store_fare_3}
    ...    ${car_itinerary}    ${hotel_itinerary}    ${select_hotel}    ${select_rate}    ${store_hotel_rate}    @{exclude_panels}
    Set Test Variable    ${client_account}    ${EMPTY}
    Set Client And Traveler    ${client}    ${surname}    ${firstname}
    Click New Booking
    Update PNR for EN or GB
    Book Flight X Months From Now    ${city_pair_1}    ${seat_select_1}    ${store_fare_1}    6
    Book Flight X Months From Now    ${city_pair_2}    ${seat_select_2}    ${store_fare_2}    6    2
    Book Flight X Months From Now    ${city_pair_3}    ${seat_select_3}    ${store_fare_3}    6    4
    Book Active Car Segment    ${car_itinerary}    6    0    6    8
    Book Hotel Segment    ${hotel_itinerary}    ${select_hotel}    ${select_rate}    ${store_hotel_rate}
    Click Read Booking
    Populate All Panels (Except Given Panels If Any)    @{exclude_panels}

Create New Booking With One Way Flight And One Alternate Offer Using Default Values
    [Arguments]    ${client}    ${surname}    ${firstname}    ${city_pair}    ${seat_select}    ${store_fare}
    ...    ${client_account}=${EMPTY}    @{exclude_panels}
    Set Client And Traveler    ${client}    ${surname}    ${firstname}
    Click New Booking
    Update PNR for EN or GB
    Create Amadeus Offer    ${city_pair}    ${seat_select}    ${store_fare}
    Get Data From GDS Screen
    Click Read Booking
    Populate All Panels (Except Given Panels If Any)    @{exclude_panels}

Create New Booking With Round Trip Flight And One Alternate Offer Using Default Values
    [Arguments]    ${client}    ${surname}    ${firstname}    ${city_pair_1}    ${seat_select_1}    ${store_fare_1}
    ...    ${store_offer_1}    ${city_pair_2}    ${seat_select_2}    ${store_fare_2}    ${client_account}=${EMPTY}    @{exclude_panels}
    Set Client And Traveler    ${client}    ${surname}    ${firstname}
    Click New Booking
    Update PNR for EN or GB
    Create Amadeus Offer    ${city_pair_1}    ${seat_select_1}    ${store_fare_1}    6    0    ${store_offer_1}
    Book Flight X Months From Now    ${city_pair_2}    ${seat_select_2}    ${store_fare_2}    6    2
    Get Data From GDS Screen
    Click Read Booking
    Populate All Panels (Except Given Panels If Any)    @{exclude_panels}

Create New Booking With Round Trip Flight And Two Alternate Offers Using Default Values
    [Arguments]    ${client}    ${surname}    ${firstname}    ${city_pair_1}    ${seat_select_1}    ${store_fare_1}
    ...    ${store_offer_1}    ${city_pair_2}    ${seat_select_2}    ${store_fare_2}    ${store_offer_2}    ${client_account}=${EMPTY}
    ...    @{exclude_panels}
    Set Client And Traveler    ${client}    ${surname}    ${firstname}
    Click New Booking
    Update PNR for EN or GB
    Create Amadeus Offer    ${city_pair_1}    ${seat_select_1}    ${store_fare_1}    6    0    ${store_offer_1}
    Create Amadeus Offer    ${city_pair_2}    ${seat_select_2}    ${store_fare_2}    6    2    ${store_offer_2}
    Get Data From GDS Screen
    Click Read Booking
    Populate All Panels (Except Given Panels If Any)    @{exclude_panels}

Create New Booking With Round Trip Flight Rail Cars And Hotel
    [Arguments]    ${client}    ${surname}    ${firstname}    ${city_pair_1}    ${seat_select_1}    ${store_fare_1}
    ...    ${city_pair_2}    ${seat_select_2}    ${store_fare_2}    ${car_itinerary}    ${hotel_itinerary}    ${select_hotel}
    ...    ${select_rate}    ${store_hotel_rate}    @{exclude_panels}
    Set Test Variable    ${client_account}    ${EMPTY}
    Set Client And Traveler    ${client}    ${surname}    ${firstname}
    Click New Booking
    Click Create Shell
    Create One Way Rail Booking Using Amadeus Rail Display Thru Web    PARWL210G    FRPLY    FRLPD    E-ticket    SNCF
    Activate Power Express Window
    Sleep    2
    Book Flight X Months From Now    ${city_pair_1}    ${seat_select_1}    ${store_fare_1}    6
    Book Flight X Months From Now    ${city_pair_2}    ${seat_select_2}    ${store_fare_2}    6    10
    #Book Flight X Months From Now    ${city_pair_3}    ${seat_select_3}    ${store_fare_3}    6    4
    #Click Read Booking
    Book Active Car Segment    ${car_itinerary}    6    0    6    8
    Book Hotel Segment    ${hotel_itinerary}    ${select_hotel}    ${select_rate}    ${store_hotel_rate}
    #Update PNR for EN or GB
    Click Read Booking
    Populate All Panels (Except Given Panels If Any)    @{exclude_panels}

Delete Alternate Fare Tab
    [Arguments]    ${tab_number}
    Click Fare Tab    ${tab_number}
    Click Remove Alternate Fare

Get Air Fare Restrictions
    [Arguments]    ${fare_tab}
    Get Changes Value    ${fare_tab}
    Get Cancellation Value    ${fare_tab}
    Get Valid On Value    ${fare_tab}
    Get Re-Route Value    ${fare_tab}
    Get Mininum Stay Value    ${fare_tab}
    Get Maximum Stay Value    ${fare_tab}

Get Airline Commission Percentage Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${airline_commission_percentage_field}    Determine Multiple Object Name Based On Active Tab    cmbAirCommissionPercentage
    ${airline_commission_percentage}    Get Control Text Value    ${airline_commission_percentage_field}
    Set Test Variable    ${airline_commission_percentage}

Get Airline Offer
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${airline_offer_field}    Determine Multiple Object Name Based On Active Tab    ctxtAirlineOffer_alt
    ${airline_offer} =    Get Control Text Value    ${airline_offer_field}
    Set Suite Variable    ${airline_offer_alt_${fare_tab_index}}    ${airline_offer}

Get Airline Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_fare_tab_alternate}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_fare_tab_alternate} == True    alt_${fare_tab_index}    ${fare_tab_index}
    ${airline_field}    Determine Multiple Object Name Based On Active Tab    ctxtAirlineOffer_alt
    ${airline_value}    Get Control Text Value    ${airline_field}
    Set Test Variable    ${airline_value_${fare_tab_index}}    ${airline_value}

Get Alternate Fare Details
    [Arguments]    ${fare_tab}
    Click Fare Tab    ${fare_tab}
    Get Fare Basis Offer    ${fare_tab}
    Get Airline Offer    ${fare_tab}
    Get Air Fare Restrictions    ${fare_tab}
    Get Fare Class Value    ${fare_tab}
    Get Details Offer    ${fare_tab}
    Get Total Fare Offer    ${fare_tab}
    Get Routing Name    ${fare_tab}
    Get Alternate Fare Routing Value    ${fare_tab}
    [Teardown]    Take Screenshot

Get Alternate Fare Fuel Surcharge Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_visible}    Determine Control Object Is Visible On Active Tab    ctxtFuelSurchargeOffer_alt
    ${alternate_fare_fuel_surcharge_field}    Run Keyword If    "${is_visible}" == "True"    Determine Multiple Object Name Based On Active Tab    ctxtFuelSurchargeOffer_alt
    ${alternate_fare_fuel_surcharge_amount}    Run Keyword If    "${is_visible}" == "True"    Get Control Text Value    ${alternate_fare_fuel_surcharge_field}
    ...    ELSE    Set Variable    0
    Set Test Variable    ${alternate_fare_fuel_surcharge_amount}
    Set Test Variable    ${alternate_fare_fuel_surcharge_value_${fare_tab_index}}    ${alternate_fare_fuel_surcharge_amount}

Get Alternate Fare Merchant Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtMerchantFeeOffer_alt
    ${alternate_fare_merchant_value}    Get Control Text Value    ${object_name}
    Set Test Variable    ${merchant_value_alt_${fare_tab_index}}    ${alternate_fare_merchant_value}

Get Alternate Fare Routing Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    cmtxtRouting_alt
    ${alternate_fare_routing_value}    Get Control Text Value    ${object_name}
    Set Test Variable    ${routing_value_alt_${fare_tab_index}}    ${alternate_fare_routing_value}

Get Alternate Fare Total Fare Value
    [Arguments]    ${fare_tab}=Alternate Fare 1
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtTotalFareOffer_alt
    ${alternate_fare_total_fare_amount}    Get Control Text Value    ${object_name}
    ${converted_alternate_fare_total_fare_amount}    Replace String    ${alternate_fare_total_fare_amount}    ,    .
    Set Test Variable    ${alternate_fare_total_fare_amount}
    Set Test Variable    ${converted_alternate_fare_total_fare_amount}
    Set Test Variable    ${total_fare_value_alt_${fare_tab_index}}    ${alternate_fare_total_fare_amount}
    Set Test Variable    ${converted_total_fare_value_alt_${fare_tab_index}}    ${converted_alternate_fare_total_fare_amount}
    [Return]    ${total_fare_value_alt_${fare_tab_index}}

Get Alternate Fare Transaction Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtTransactionFeeOffer_alt
    ${alternate_fare_transaction_amount}    Get Control Text Value    ${object_name}
    Set Test Variable    ${alternate_fare_transaction_amount}
    Set Test Variable    ${transaction_value_alt_${fare_tab_index}}    ${alternate_fare_transaction_amount}

Get Cancellation Value
    [Arguments]    ${fare_tab}    ${default_control_counter}=True    ${field_instance}=${EMPTY}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_fare_tab_alternate}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_fare_tab_alternate} == True    alt_${fare_tab_index}    ${fare_tab_index}
    ${cancellation_control}    Determine Multiple Object Name Based On Active Tab    ccboCancellations0,ccboCancellations0_alt,ccboCancellationsOBT_alt,ccboCancellationsOBT,ccboCancellations_${fare_tab_index},ccboCancellations_alt_${fare_tab_index}    ${default_control_counter}    ${field_instance}
    ${cancellation_value}    Get Control Text Value    ${cancellation_control}
    Set Suite Variable    ${cancellation_value_${fare_tab_index}}    ${cancellation_value.upper()}
    [Return]    ${cancellation_value_${fare_tab_index}}

Get Changes Value
    [Arguments]    ${fare_tab}    ${default_control_counter}=True    ${field_instance}=${EMPTY}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_fare_tab_alternate}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_fare_tab_alternate} == True    alt_${fare_tab_index}    ${fare_tab_index}
    ${changes_control}    Determine Multiple Object Name Based On Active Tab    ccboChanges0,ccboChanges0_alt,ccboChangesOBT_alt,ccboChangesOBT,ccboChanges_${fare_tab_index},ccboChanges_alt_${fare_tab_index}    ${default_control_counter}    ${field_instance}
    ${changes_value}    Get Control Text Value    ${changes_control}
    Set Suite Variable    ${changes_value_${fare_tab_index}}    ${changes_value.upper()}
    [Return]    ${changes_value_${fare_tab_index}}

Get Charged Fare Value
    [Arguments]    ${fare_tab}=Fare 1
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtChargedFare
    ${charged_fare_amount}    Get Control Text Value    ${object_name}
    ${converted_charged_fare}    Replace String    ${charged_fare_amount}    ,    .
    Set Test Variable    ${charged_fare_amount}
    Set Test Variable    ${converted_charged_fare}
    Set Suite Variable    ${charge_fare}    ${converted_charged_fare}
    Set Suite Variable    ${charged_fare_${fare_tab_index}}    ${converted_charged_fare}
    Set Suite Variable    ${charged_value_${fare_tab_index}}    ${charged_fare_amount}
    ${without_decimal_charged_fare}    Remove Decimals    ${charged_fare_${fare_tab_index}}
    Set Suite Variable    ${without_decimal_charged_fare_${fare_tab_index}}    ${without_decimal_charged_fare}

Get Commission Rebate Amount Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_visible}    Determine Control Object Is Visible On Active Tab    txtClientCommissionRebateAmount
    ${commission_rebate_amount_field}    Run Keyword If    "${is_visible}" == "True"    Determine Multiple Object Name Based On Active Tab    txtClientCommissionRebateAmount
    ${commission_rebate_amount}    Run Keyword If    "${is_visible}" == "True"    Get Control Text Value    ${commission_rebate_amount_field}
    ...    ELSE    Set Variable    0
    Set Test Variable    ${commission_rebate_value_${fare_tab_index}}    ${commission_rebate_amount}

Get Commission Rebate Percentage Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${commission_rebate_percentage_field}    Determine Multiple Object Name Based On Active Tab    txtClientCommissionRebatePercentage
    ${commission_rebate_percentage}    Get Control Text Value    ${commission_rebate_percentage_field}
    Set Test Variable    ${commission_rebate_percentage_value_${fare_tab_index}}    ${commission_rebate_percentage}

Get Details Offer
    [Arguments]    ${fare_tab}=Alternate Fare 1
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${details_offer_field}    Determine Multiple Object Name Based On Active Tab    ctxtDetailsOffer_alt
    ${details_offer} =    Get Control Text Value    ${details_offer_field}
    ${details_offer} =    Replace String    ${details_offer}    É    E
    ${details_offer} =    Replace String    ${details_offer}    Û    U
    ${details_offer} =    Run Keyword If    "${GDS_switch}" == "galileo"    Replace String    ${details_offer}    +    /
    ...    ELSE    Set Variable    ${details_offer}
    ${details_offer} =    Run Keyword If    "${GDS_switch}" == "galileo"    Replace String    ${details_offer}    ${SPACE}${SPACE}    ${SPACE}
    ...    ELSE    Set Variable    ${details_offer}
    Set Suite Variable    ${details_offer_alt_${fare_tab_index}}    ${details_offer}
    Set Suite Variable    ${alternate_airline_details_${fare_tab_index}}    ${details_offer}
    Set Suite Variable    ${alternate_airline_details}    ${details_offer}

Get Fare Basis Offer
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_fare_tab_alternate}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_fare_tab_alternate} == True    alt_${fare_tab_index}    ${fare_tab_index}
    ${fare_basis_field}    Determine Multiple Object Name Based On Active Tab    ctxtFareBasisOffer_alt
    ${fare_basis}    Get Control Text Value    ${fare_basis_field}
    Set Suite Variable    ${fare_basis_${fare_tab_index}}    ${fare_basis}
    Set Test Variable    ${fare_basis_value_${fare_tab_index}}    ${fare_basis}

Get Fare Class Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_fare_tab_alternate}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_fare_tab_alternate} == True    alt_${fare_tab_index}    ${fare_tab_index}
    ${fare_class_offer_field}    Determine Multiple Object Name Based On Active Tab    ccboFareClassOffer_alt
    ${fare_class_offer}    Get Control Text Value    ${fare_class_offer_field}
    ${fare_class_offer_text}    Fetch From Right    ${fare_class_offer}    -${SPACE}
    ${fare_class_offer_code}    Fetch From Left    ${fare_class_offer}    -${SPACE}
    ${class_code_sub}    Get Substring    ${fare_class_offer}    0    1
    ${class_code_sub}    Set Variable If    '${class_code_sub}'=='W'    P    '${class_code_sub}'=='A' or '${class_code_sub}'=='D' or '${class_code_sub}'=='F'    P    '${class_code_sub}'=='N' or '${class_code_sub}'=='M'
    ...    ${EMPTY}    ${class_code_sub}
    Set Test Variable    ${alternate_class_code}    ${class_code_sub}
    Set Test Variable    ${fare_class_offer_value_${fare_tab_index}}    ${fare_class_offer_text.upper()}
    Set Suite Variable    ${fare_class_offer_${fare_tab_index}}    ${fare_class_offer.upper()}
    Set Suite Variable    ${fare_class_offer_text_${fare_tab_index}}    ${fare_class_offer_text.upper()}
    Set Suite Variable    ${fare_class_offer_code_${fare_tab_index}}    ${fare_class_offer_code}
    [Teardown]

Get Fare Details
    [Arguments]    ${fare_tab}    ${include_fare_amount}=True
    Click Fare Tab    ${fare_tab}
    Run Keyword If    "${include_fare_amount}" == "True"    Get High, Charged And Low Fare In Fare Tab    ${fare_tab}
    Get Air Fare Restrictions    ${fare_tab}
    Get Routing Name    ${fare_tab}
    Get Point Of Turnaround    ${fare_tab}
    Get Savings Code    ${fare_tab}
    [Teardown]    Take Screenshot

Get Fare Restriction Currently Selected Value
    [Arguments]    ${fare_tab}    ${translate_to_english}=True
    Click Fare Tab    ${fare_tab}
    ${currently_selected}    Get Fare Restiction Selected Radio Button    ${translate_to_english}
    Set Test Variable    ${currently_selected}
    [Return]    ${currently_selected}

Get Fees Fare Value
    [Arguments]    ${fare_tab_name}=${EMPTY}
    ${fare_tab_index}    Fetch From Right    ${fare_tab_name}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtFees
    ${object_visibility}    Control Command    ${title_power_express}    ${EMPTY}    ${object_name}    IsVisible    ${EMPTY}
    ${fees_fare_amount}    Run Keyword If    ${object_visibility} == 1    Get Control Text Value    ${object_name}
    ...    ELSE    Set Variable    0
    ${converted_fees_fare}    Replace String    ${fees_fare_amount}    ,    .
    Set Test Variable    ${converted_fees_fare}
    Set Test Variable    ${fees_fare_${fare_tab_index}}    ${fees_fare_amount}

Get Fees Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtFees
    ${fees_value}    Get Control Text Value    ${object_name}
    Set Test Variable    ${fees_value_${fare_tab_index}}    ${fees_value}
    [Return]    ${fees_value_${fare_tab_index}}

Get Fuel Surcharge Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${fuel_surcharge_field}    Determine Multiple Object Name Based On Active Tab    txtFuelSurcharge
    ${fuel_surcharge}    Get Control Text Value    ${fuel_surcharge_field}
    Set Test Variable    ${fuel_surcharge_value_${fare_tab_index}}    ${fuel_surcharge}

Get High Fare Value
    [Arguments]    ${fare_tab}=Fare 1
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtHighFare
    ${high_fare_amount}    Get Control Text Value    ${object_name}
    ${converted_high_fare}    Replace String    ${high_fare_amount}    ,    .
    Set Test Variable    ${converted_high_fare}
    Set Test Variable    ${high_fare_amount}
    Set Suite Variable    ${high_fare}    ${converted_high_fare}
    Set Suite Variable    ${high_fare_${fare_tab_index}}    ${converted_high_fare}
    Set Suite Variable    ${high_fare_value_${fare_tab_index}}    ${high_fare_amount}
    ${without_decimal_high_fare}    Remove Decimals    ${high_fare_${fare_tab_index}}
    Set Suite Variable    ${without_decimal_high_fare_${fare_tab_index}}    ${without_decimal_high_fare}

Get High, Charged And Low Fare In Fare Tab
    [Arguments]    ${fare_tab_value}=Fare 1
    Activate Power Express Window
    Click Fare Tab    ${fare_tab_value}
    Get Charged Fare Value    ${fare_tab_value}
    Get High Fare Value    ${fare_tab_value}
    Get Low Fare Value    ${fare_tab_value}
    [Teardown]    Take Screenshot

Get Low Fare Value
    [Arguments]    ${fare_tab}=Fare 1
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtLowFare
    ${low_fare_amount}    Get Control Text Value    ${object_name}
    ${converted_low_fare}    Replace String    ${low_fare_amount}    ,    .
    Set Test Variable    ${converted_low_fare}
    Set Test Variable    ${low_fare_amount}
    Set Suite Variable    ${low_fare}    ${converted_low_fare}
    Set Suite Variable    ${low_fare_${fare_tab_index}}    ${converted_low_fare}
    Set Suite Variable    ${low_fare_value_${fare_tab_index}}    ${low_fare_amount}
    ${without_decimal_low_fare}    Remove Decimals    ${low_fare_${fare_tab_index}}
    Set Suite Variable    ${without_decimal_low_fare_${fare_tab_index}}    ${without_decimal_low_fare}

Get Mark-Up Amount Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_visible}    Determine Control Object Is Visible On Active Tab    txtMarkupAmount
    ${mark_up_amount_field}    Run Keyword If    "${is_visible}" == "True"    Determine Multiple Object Name Based On Active Tab    txtMarkupAmount
    ${mark_up_amount}    Run Keyword If    "${is_visible}" == "True"    Get Control Text Value    ${mark_up_amount_field}
    ...    ELSE    Set Variable    0
    Set Test Variable    ${mark_up_value_${fare_tab_index}}    ${mark_up_amount}

Get Mark-Up Percentage Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    txtMarkupPercentage
    ${mark_up_percentage}    Get Control Text Value    ${object_name}
    Set Test Variable    ${mark_up_percentage_value_${fare_tab_index}}    ${mark_up_percentage}

Get Maximum Stay Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_fare_tab_alternate}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_fare_tab_alternate} == True    alt_${fare_tab_index}    ${fare_tab_index}
    ${max_stay_dropdown}    Determine Multiple Object Name Based On Active Tab    ccboMaxStay,ccboMaxStay_alt,ccboMaxStayOBT,ccboMaxStayOBT_alt
    ${max_stay}    Get Control Text Value    ${max_stay_dropdown}
    Set Suite Variable    ${max_stay_value_${fare_tab_index}}    ${max_stay}
    Set Suite Variable    ${max_stay_${fare_tab_index}}    ${max_stay}

Get Merchant Fee Amount Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_visible}    Determine Control Object Is Visible On Active Tab    txtMerchantFeeAmount
    ${merchant_fee_amount_field}    Run Keyword If    "${is_visible}" == "True"    Determine Multiple Object Name Based On Active Tab    txtMerchantFeeAmount
    ${merchant_fee_amount}    Run Keyword If    "${is_visible}" == "True"    Get Control Text Value    ${merchant_fee_amount_field}
    ...    ELSE    Set Variable    0
    ${merchant_fee_amount}    Set Variable If    "${merchant_fee_amount}" == "${EMPTY}"    0    ${merchant_fee_amount}
    Set Suite Variable    ${merchant_fee_value_${fare_tab_index}}    ${merchant_fee_amount}

Get Merchant Fee Percentage Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    txtMerchantFeePercentage
    ${merchant_fee_percentage}    Get Control Text Value    ${object_name}
    Set Test Variable    ${merchant_fee_percentage_value_${fare_tab_index}}    ${merchant_fee_percentage}

Get Mininum Stay Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_fare_tab_alternate}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_fare_tab_alternate} == True    alt_${fare_tab_index}    ${fare_tab_index}
    ${min_stay_dropdown}    Determine Multiple Object Name Based On Active Tab    ccboMinStay,ccboMinStayOBT,ccboMinStay_alt, ccboMinStayOBT_alt
    ${min_stay}    Get Control Text Value    ${min_stay_dropdown}
    Set Suite Variable    ${min_stay_value_${fare_tab_index}}    ${min_stay}
    Set Suite Variable    ${min_stay_${fare_tab_index}}    ${min_stay}

Get Nett Fare Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${nett_fare_field}    Determine Multiple Object Name Based On Active Tab    txtNettFareAmount
    ${nett_fare_amount}    Get Control Text Value    ${nett_fare_field}
    ${nett_fare_amount}    Set Variable If    "${nett_fare_amount}" == "${EMPTY}"    0    ${nett_fare_amount}
    Set Test Variable    ${nett_fare_value_${fare_tab_index}}    ${nett_fare_amount}

Get Overall Total Fares
    [Arguments]    @{fares}
    @{high_fare_list}    Create List
    @{charged_fare_list}    Create List
    @{low_fare_list}    Create List
    @{fees_fare_list}    Create List
    : FOR    ${fare}    IN    @{fares}
    \    ${fare_tab_index}    Fetch From Right    ${fare}    ${SPACE}
    \    Append To List    ${high_fare_list}    ${high_fare_${fare_tab_index}}
    \    Append To List    ${charged_fare_list}    ${charged_fare_${fare_tab_index}}
    \    Append To List    ${low_fare_list}    ${low_fare_${fare_tab_index}}
    \    Append To List    ${fees_fare_list}    ${fees_fare_${fare_tab_index}}
    ${high_fare_total_fares}    Get Total Fares    @{high_fare_list}    @{fees_fare_list}
    ${charged_fare_total_fares}    Get Total Fares    @{charged_fare_list}    @{fees_fare_list}
    ${low_fare_total_fares}    Get Total Fares    @{low_fare_list}    @{fees_fare_list}
    Set Test Variable    ${high_fare_total_fares}
    Set Test Variable    ${charged_fare_total_fares}
    Set Test Variable    ${low_fare_total_fares}

Get Point Of Turnaround
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_fare_tab_alternate}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_fare_tab_alternate} == True    alt_${fare_tab_index}    ${fare_tab_index}
    ${point_of_obj}    Determine Multiple Object Name Based On Active Tab    ccboPOT
    ${actual_point_of}    Get Control Text Value    ${point_of_obj}
    Set Suite Variable    ${point_of_${fare_tab_index}}    ${actual_point_of}

Get Re-Route Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_fare_tab_alternate}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_fare_tab_alternate} == True    alt_${fare_tab_index}    ${fare_tab_index}
    ${reroute_control}    Determine Multiple Object Name Based On Active Tab    ccboReRoute, ccboReRouteOBT, ccboReRouteOBT_alt, ccboReRoute_alt
    ${reroute_value}    Get Control Text Value    ${reroute_control}
    Set Suite Variable    ${reroute_value_${fare_tab_index}}    ${reroute_value.upper()}
    [Return]    ${reroute_value_${fare_tab_index}}

Get Route Code Value
    [Arguments]    ${fare_tab}    ${default_control_counter}=True
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    cbRouteGeographyCode,RouteCodeComboBox    ${default_control_counter}
    ${route_code}    Get Control Text Value    ${object_name}
    Set Suite Variable    ${route_code_${fare_tab_index}}    ${route_code}

Get Routing Name
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_alternate_tab}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_alternate_tab}==True    alt_${fare_tab_index}    ${fare_tab_index}
    ${actual_city_route}    Get Routing Value    ${fare_tab}
    @{city_route}    Split String    ${actual_city_route}    -
    ${city_names}    ${city_names_with_dash}    ${city_names_with_slash}    Get City Name    @{city_route}
    Set Suite Variable    ${city_names_${fare_tab_index}}    ${city_names}
    Set Suite Variable    ${city_names_with_dash_${fare_tab_index}}    ${city_names_with_dash}
    ${city_names_with_slash}    Get Substring    ${city_names_with_slash}    1
    Set Suite Variable    ${city_names_with_slash_${fare_tab_index}}    ${city_names_with_slash}
    [Teardown]

Get Routing Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_alternate_tab}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_alternate_tab}==True    alt_${fare_tab_index}    ${fare_tab_index}
    ${routing_obj}    Determine Multiple Object Name Based On Active Tab    cmtxtRouting_alt,cmtxtRouting
    ${actual_city_route}    Get Control Text Value    ${routing_obj}
    Set Suite Variable    ${city_route_${fare_tab_index}}    ${actual_city_route}
    [Teardown]
    [Return]    ${actual_city_route}

Get Savings Code
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${missed_field}    Determine Multiple Object Name Based On Active Tab    ccboMissed
    ${realised_field}    Determine Multiple Object Name Based On Active Tab    ccboRealised
    ${class_field}    Determine Multiple Object Name Based On Active Tab    ccboClass
    ${missed_value}    Get Control Text Value    ${missed_field}
    ${realised_value}    Get Control Text Value    ${realised_field}
    ${class_value}    Get Control Text Value    ${class_field}
    ${missed_code_value}    Fetch From Left    ${missed_value}    ${SPACE}-
    ${realised_code_value}    Fetch From Left    ${realised_value}    ${SPACE}-
    ${class_code_value}    Fetch From Left    ${class_value}    ${SPACE}-
    #Sets only savings code
    Set Suite Variable    ${missed_code_value_${fare_tab_index}}    ${missed_code_value}
    Set Suite Variable    ${realised_code_value_${fare_tab_index}}    ${realised_code_value}
    Set Suite Variable    ${class_code_value_${fare_tab_index}}    ${class_code_value}
    #Sets only savings code and description
    Set Suite Variable    ${missed_text_value_${fare_tab_index}}    ${missed_value}
    Set Suite Variable    ${realised_text_value_${fare_tab_index}}    ${realised_value}
    Set Suite Variable    ${class_text_value_${fare_tab_index}}    ${class_value}

Get Single Flight Details
    [Arguments]    ${pair}=${EMPTY}
    Get Data From GDS Screen
    ${city_pair}    Get Variable Value    ${city_pair}    ${pair}
    ${flight_detail_line}    Get Lines Containing String    ${gds_screen_data}    ${city_pair}
    ${flight_details}    Get Required Flight Details    ${flight_detail_line}    ${city_pair}
    ${segment_number}    Run Keyword If    '${GDS_switch}' == 'amadeus'    Get Substring    ${flight_detail_line}    2    3
    ...    ELSE IF    '${GDS_switch}' == 'sabre'    Get Substring    ${flight_detail_line}    1    2
    ${first_index_length}    Get Length    ${flight_details[0]}
    ${airline_code}    Run Keyword If    ${first_index_length} < 3    Set Variable    ${flight_details[0]}
    ...    ELSE    Get Substring    ${flight_details[0]}    0    2
    ${flight_number}    Run Keyword If    '${GDS_switch}' != 'sabre' and ${first_index_length} < 3    Set Variable    ${flight_details[1]}
    ...    ELSE IF    '${GDS_switch}' == 'sabre' and ${first_index_length} < 3    Get Substring    ${flight_details[1]}    \    -1
    ...    ELSE    Get Substring    ${flight_details[0]}    2    6
    ${fare_class}    Run Keyword If    '${GDS_switch}' != 'sabre' and ${first_index_length} < 3    Set Variable    ${flight_details[2]}
    ...    ELSE IF    '${GDS_switch}' == 'sabre' and ${first_index_length} < 3    Get Substring    ${flight_details[1]}    -1
    ...    ELSE IF    '${GDS_switch}' == 'sabre' and ${first_index_length} > 3    Get Substring    ${flight_details[0]}    -1
    ...    ELSE    Set Variable    ${flight_details[1]}
    ${flight_date}    Run Keyword If    '${GDS_switch}' != 'sabre' and ${first_index_length} < 3    Set Variable    ${flight_details[3]}
    ...    ELSE IF    '${GDS_switch}' == 'sabre' and ${first_index_length} < 3    Set Variable    ${flight_details[2]}
    ...    ELSE IF    '${GDS_switch}' == 'sabre' and ${first_index_length} > 3    Set Variable    ${flight_details[1]}
    ...    ELSE    Set Variable    ${flight_details[2]}
    ${flight_origin}    Run Keyword If    ${first_index_length} < 3 and '${GDS_switch}' != 'amadeus'    Get Substring    ${flight_details[4]}    0    3
    ...    ELSE IF    ${first_index_length} < 3 and '${GDS_switch}' == 'amadeus'    Get Substring    ${flight_details[5]}    0    3
    ...    ELSE IF    '${GDS_switch}' == 'amadeus' and ${first_index_length} > 3    Get Substring    ${flight_details[4]}    0    3
    ...    ELSE    Get Substring    ${flight_details[3]}    0    3
    ${flight_destination}    Run Keyword If    ${first_index_length} < 3 and '${GDS_switch}' != 'amadeus'    Get Substring    ${flight_details[4]}    3    6
    ...    ELSE IF    ${first_index_length} < 3 and '${GDS_switch}' == 'amadeus'    Get Substring    ${flight_details[5]}    3    6
    ...    ELSE IF    '${GDS_switch}' == 'amadeus' and ${first_index_length} > 3    Get Substring    ${flight_details[4]}    3    6
    ...    ELSE    Get Substring    ${flight_details[3]}    3    6
    Run Keyword If    '${GDS_switch}' == 'amadeus' and '${locale}' == 'fr-FR'    Convert English Date To French    ${flight_date}
    Run Keyword If    '${GDS_switch}' == 'amadeus'    Set Test Variable    ${segment_number}    ${segment_number.strip()}
    Set Test Variable    ${airline_code}
    Set Test Variable    ${flight_number}
    Set Test Variable    ${fare_class}
    Set Test Variable    ${flight_date}
    Set Test Variable    ${flight_origin}
    Set Test Variable    ${flight_destination}

Get Sum Of X Number Of Alternate Fares
    [Arguments]    ${number_of_fares}
    Set Test Variable    ${alternate_fare_total}    0
    Activate Power Express Window
    Click Panel    Air Fare
    : FOR    ${counter}    IN RANGE    1    ${number_of_fares}+1
    \    Click Fare Tab    Alternate Fare ${counter}
    \    ${total_fare_value}    Get Alternate Fare Total Fare Value
    \    ${alternate_fare_total}    Evaluate    ${alternate_fare_total} + ${total_fare_value}
    Set Test Variable    ${alternate_fare_total}

Get Sum Of X Number Of Fares
    [Arguments]    ${number_of_fares}
    Set Test Variable    ${fare_total}    0
    Activate Power Express Window
    Click Panel    Air Fare
    : FOR    ${counter}    IN RANGE    1    ${number_of_fares}+1
    \    Click Fare Tab    Fare ${counter}
    \    Get Charged Fare Value
    \    ${fare_total}    Evaluate    ${fare_total} + ${charged_fare_amount}
    Set Test Variable    ${fare_total}

Get Total Alternate Fare Amount X Tab
    [Arguments]    ${alternate_fare_tab}    ${country}
    ${fare_tab_index}    Fetch From Right    ${alternate_fare_tab}    ${SPACE}
    Get Alternate Fare Transaction Value    ${alternate_fare_tab}
    Get Alternate Fare Merchant Value    ${alternate_fare_tab}
    Get Alternate Fare Fuel Surcharge Value    ${alternate_fare_tab}
    Get Alternate Fare Total Fare Value    ${alternate_fare_tab}
    ${total_alternate_fare}    Evaluate    ${merchant_value_alt_${fare_tab_index}} + ${transaction_value_alt_${fare_tab_index}} + ${alternate_fare_fuel_surcharge_value_${fare_tab_index}} + ${total_fare_value_alt_${fare_tab_index}}
    ${total_alternate_fare}    Convert To String    ${total_alternate_fare}
    ${total_alternate_fare}    Run Keyword If    "${country}" == "SG"    Convert To Float    ${total_alternate_fare}
    ...    ELSE IF    "${country}" == "HK"    Fetch From Left    ${total_alternate_fare}    .
    ...    ELSE    Set Variable    ${total_alternate_fare}
    Set Test Variable    ${total_alternate_fare_amount_${fare_tab_index}}    ${total_alternate_fare}

Get Total Fare Offer
    [Arguments]    ${fare_tab}
    Activate Power Express Window
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${total_fare_field}    Determine Multiple Object Name Based On Active Tab    ctxtTotalFareOffer_alt
    ${total_fare} =    Get Control Text Value    ${total_fare_field}
    ${total_fare} =    Run Keyword If    "${GDS_switch}" == "amadeus"    Replace String    ${total_fare}    ,    .
    ...    ELSE    Set Variable    ${total_fare}
    ${total_fare} =    Run Keyword If    "${GDS_switch}" == "amadeus"    Convert To Float    ${total_fare}
    ...    ELSE    Set Variable    ${total_fare}
    Set Suite Variable    ${total_fare_alt_${fare_tab_index}}    ${total_fare}
    [Return]    ${total_fare_alt_${fare_tab_index}}

Get Total Fares
    [Arguments]    @{fares}
    ${total_fare_list}    Evaluate    map(float, @{fares})
    ${total_fare}    Evaluate    math.fsum(${total_fare_list})    math
    [Return]    ${total_fare}

Get Total For All Tickets Value With Alternate Fare Total Fare
    [Arguments]    ${alternate_fare_number}
    Get Sum Of X Number Of Alternate Fares    ${alternate_fare_number}
    ${fare_total_with_alternate}    Convert To String    ${alternate_fare_total}
    ${fare_total_with_alternate}    Run Keyword If    "${currency}" == "HKD"    Fetch From Left    ${fare_total_with_alternate}    .
    ...    ELSE    Set Variable    ${fare_total_with_alternate}
    ${fare_total_with_alternate}    Evaluate    ${total_for_all_tickets_value} + ${alternate_fare_total}
    Set Test Variable    ${fare_total_with_alternate}

Get Total Of High Fare, Charged Fare And Low Fare For ${number_of_fares} Fare Tabs
    Set Test Variable    ${total_high_fare}    0
    Set Test Variable    ${total_charged_fare}    0
    Set Test Variable    ${total_low_fare}    0
    : FOR    ${index}    IN RANGE    1    ${number_of_fares}+1
    \    Click Fare Tab    Fare ${index}
    \    Get Charged Fare Value    Fare ${index}
    \    Get High Fare Value    Fare ${index}
    \    Get Low Fare Value    Fare ${index}
    \    Get Fees Fare Value    Fare ${index}
    \    ${total_high_fare}    Evaluate    ${total_high_fare} + ${high_fare_value_${index}} + ${fees_fare_${index}}
    \    ${total_charged_fare}    Evaluate    ${total_charged_fare} + ${charged_value_${index}} + ${fees_fare_${index}}
    \    ${total_low_fare}    Evaluate    ${total_low_fare} + ${low_fare_value_${index}} + ${fees_fare_${index}}
    Set Test Variable    ${total_high_fare}
    Set Test Variable    ${total_charged_fare}
    Set Test Variable    ${total_low_fare}
    [Teardown]    Take Screenshot

Get Transaction Fee Amount Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    cmbTransactionFee
    ${transaction_fee_amount}    Get Control Text Value    ${object_name}
    ${transaction_fee_amount}    Fetch From Left    ${transaction_fee_amount}    -
    Set Suite Variable    ${transaction_fee_value_${fare_tab_index}}    ${transaction_fee_amount}

Get Valid On Value
    [Arguments]    ${fare_tab}
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${is_fare_tab_alternate}    Run Keyword And Return Status    Should Contain    ${fare_tab.lower()}    alternate
    ${fare_tab_index}    Set Variable If    ${is_fare_tab_alternate} == True    alt_${fare_tab_index}    ${fare_tab_index}
    ${valid_on_obj}    Determine Multiple Object Name Based On Active Tab    ccboValidOnOBT, ccboValidOnOBT_alt, ccboValidOn_alt, ccboValidOn
    ${actual_valid_on}    Get Control Text Value    ${valid_on_obj}
    Set Suite Variable    ${valid_on_${fare_tab_index}}    ${actual_valid_on}
    Set Suite Variable    ${valid_on_value_${fare_tab_index}}    ${actual_valid_on}

Populate Air Fare Panel With Default Values
    Tick Fare Not Finalised
    [Teardown]

Populate Air Fare Restrictions
    [Arguments]    ${air_fare_restriction}    ${changes_value}    ${cancellation_value}    ${valid_on_value}    ${re_route_value}    ${min_stay_value}
    ...    ${max_stay_value}    ${fare_tab}=Fare 1
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    Select Fare Restriction    ${air_fare_restriction}
    Set Changes Value    ${changes_value}    ${fare_tab}
    Set Cancellation Value    ${cancellation_value}    ${fare_tab}
    Select Valid On Dropdown Value    ${valid_on_value}
    Select Re-Route Dropdown Value    ${re_route_value}
    Select Min Stay Dropdown Value    ${min_stay_value}
    Select Max Stay Dropdown Value    ${max_stay_value}
    [Teardown]    Take Screenshot

Populate Air Fare Restrictions Using Default Values
    Select Fare Restriction    Fully Flexible
    ${changes_field}    Determine Multiple Object Name Based On Active Tab    ccboChangesOBT,ccboChanges0,ccboChangesOBT_alt,ccboChanges_alt,ccboChanges_${fare_tab_index},ccboChanges_alt_${fare_tab_index}
    Control Focus    ${title_power_express}    ${EMPTY}    ${changes_field}
    Send    {DOWN}{TAB}
    ${cancellation_field}    Determine Multiple Object Name Based On Active Tab    ccboCancellationsOBT,ccboCancellations0,ccboCancellationsOBT_alt,ccboCancellations_alt,ccboCancellations_${fare_tab_index},ccboCancellations_alt_${fare_tab_index}
    Control Focus    ${title_power_express}    ${EMPTY}    ${cancellation_field}
    Send    {DOWN}{TAB}
    [Teardown]    Take Screenshot

Populate Air Fare Savings Code
    [Arguments]    ${realised_saving}    ${missed_saving}    ${class_code}
    Activate Power Express Window
    Select Realised Saving Code Value    ${realised_saving}
    Select Missed Saving Code Value    ${missed_saving}
    Select Class Code Value    ${class_code}
    [Teardown]    Take Screenshot

Populate Air Fare Savings Code Using Default Values
    Activate Power Express Window
    ${realised_saving_code_dropdown}    Determine Multiple Object Name Based On Active Tab    ccboRealised
    ${missed_saving_code_dropdown}    Determine Multiple Object Name Based On Active Tab    ccboMissed
    ${class_code_dropdown}    Determine Multiple Object Name Based On Active Tab    ccboClass
    Control Focus    ${title_power_express}    ${EMPTY}    ${realised_saving_code_dropdown}
    Send    {DOWN}
    Sleep    0.5
    Send    {TAB}
    Control Focus    ${title_power_express}    ${EMPTY}    ${missed_saving_code_dropdown}
    Send    {DOWN}
    Sleep    0.5
    Send    {TAB}
    Control Focus    ${title_power_express}    ${EMPTY}    ${class_code_dropdown}
    Send    {DOWN}
    Sleep    0.5
    Send    {TAB}
    Sleep    0.5
    [Teardown]    Take Screenshot

Populate Air Savings Code
    [Arguments]    ${realised}    ${missed}    ${class}
    Select Realised Saving Code Value    ${realised}
    Select Missed Saving Code Value    ${missed}
    Select Class Code Value    ${class}

Populate Alternate Fare Details
    [Arguments]    ${routing}    ${airline}    ${total_fare}    ${fare_basis}    ${details}
    Set Alternate Fare Routing    ${routing}
    Set Alternate Fare Airline    ${airline}
    Set Alternate Fare Amount    ${total_fare}
    Set Alternate Fare Fare Basis    ${fare_basis}
    Set Alternate Fare Details    ${details}
    Select Alternate Fare Class Code
    Select Fare Restriction    Fully Flexible
    [Teardown]    Take Screenshot

Populate Alternate Fare Details Using Copy Air Button
    [Arguments]    ${fare_basis_details}    ${total_fare}    ${class_code}
    Click Copy Alternate Fare
    Set Alternate Fare Fare Basis    ${fare_basis_details}
    Set Alternate Fare Amount    ${total_fare}
    Select Alternate Fare Class Code    ${class_code}
    Select Fare Restriction    Fully Flexible
    [Teardown]    Take Screenshot

Populate Alternate Fare With Default Values
    [Arguments]    ${fare_tab_value}
    Click Panel    Air Fare
    Click Fare Tab    ${fare_tab_value}
    Select Fare Restriction    Fully Flexible
    Select Alternate Fare Class Code
    [Teardown]    Take Screenshot

Populate Fare Tab With Default Values
    [Arguments]    ${tab_number}    ${savings_default}=false    ${fare_restriction_default}=false    ${turnaround}=${EMPTY}
    Click Panel    Air Fare
    Click Fare Tab    ${tab_number}
    Verify No Fares Found Message Is Not Present
    Set High Fare Field (If blank) with Charged Fare
    Set Low Fare Field (If blank) with Charged Fare
    Run Keyword If    '${savings_default}' != 'true'    Populate Air Fare Savings Code Using Default Values
    Run Keyword If    '${fare_restriction_default}' != 'true'    Populate Air Fare Restrictions Using Default Values
    Select Turnaround    ${turnaround}
    [Teardown]    Take Screenshot

Populate Missed Saving Code If Enabled
    [Arguments]    ${fare_tab_value}    ${missed_savings_selection}=${EMPTY}
    ${fare_tab_index} =    Fetch From Right    ${fare_tab_value}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ccboMissed
    ${is_enabled} =    Control Command    ${title_power_express}    ${EMPTY}    ${object_name}    IsEnabled    ${EMPTY}
    ${fare_code_value}    Get Sub String    ${missed_savings_selection}    0    1
    Run Keyword If    '${is_enabled}' == '1'    Select Value From Dropdown List    ${object_name}    ${missed_savings_selection}
    Run Keyword If    '${is_enabled}' == '0'    Log    Missed saving field code is disabled
    Run Keyword If    '${is_enabled}' == '1'    Set test Variable    ${fare_code_value${fare_tab_index}}    ${fare_code_value}
    Run Keyword If    '${is_enabled}' == '0'    Set test Variable    ${fare_code_value${fare_tab_index}}    L
    [Teardown]    Take Screenshot

Populate Pricing Extras Fields
    [Arguments]    ${airline_commission_percentage}    ${commission_rebate_percentage}    ${nett_fare}    ${transaction_fee}    ${mark_up_percentage}    ${merchant_fee_percentage}
    Select Airline Commission Percentage    ${airline_commission_percentage}
    Set Commission Rebate Percentage    ${commission_rebate_percentage}
    Select Transaction Fee    ${transaction_fee}
    Set Nett Fare Field    ${nett_fare}
    Set Mark-up Percentage Field    ${mark_up_percentage}
    Set Merchant Fee Percentage Field    ${merchant_fee_percentage}
    [Teardown]    Take Screenshot

Populate Realised Saving Code If Enabled
    [Arguments]    ${fare_tab_value}    ${realised_savings_selection}=${EMPTY}
    ${fare_tab_index} =    Fetch From Right    ${fare_tab_value}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ccboRealised
    ${is_enabled} =    Control Command    ${title_power_express}    ${EMPTY}    ${object_name}    IsEnabled    ${EMPTY}
    ${fare_code_value}    Get Sub String    ${realised_savings_selection}    0    1
    Run Keyword If    '${is_enabled}' == '1'    Select Value From Dropdown List    ${object_name}    ${realised_savings_selection}
    Run Keyword If    '${is_enabled}' == '0'    Log    Realised saving field code is disabled
    Run Keyword If    '${is_enabled}' == '1'    Set test Variable    ${fare_code_value${fare_tab_index}}    ${fare_code_value}
    Run Keyword If    '${is_enabled}' == '0'    Set test Variable    ${fare_code_value${fare_tab_index}}    L
    [Teardown]    Take Screenshot

Remove Fare Tab
    [Arguments]    ${tab_number}
    Click Panel    Air Fare
    Click Fare Tab    ${tab_number}
    Click Remove Alternate Fare
    Verify Fare Tab Is Not Visible    ${tab_number}

Select Airline Commission Percentage
    [Arguments]    ${str_valuetoset}    ${command}=SEND
    ${object_name}    Determine Multiple Object Name Based On Active Tab    cmbAirCommissionPercentage
    ${bg_color}    Determine Control Object Background Color    ${object_name}
    Run Keyword If    "${command}" == "SEND" and "${bg_color}" != "D3D3D3"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Set Control Text Value    ${object_name}    ${EMPTY}    ${title_power_express}
    ...    AND    Send    ${str_valuetoset}
    ...    AND    Send    {TAB}
    ...    AND    Verify Control Object Text Value Is Correct    ${object_name}    ${str_valuetoset}    Airline Commission Percentage is successfully set to ${str_valuetoset}
    ...    ELSE IF    "${command}" == "SELECT" and "${bg_color}" != "D3D3D3"    Run Keyword    Select Value From Dropdown List    ${object_name}    ${str_valuetoset}
    ...    ELSE IF    "${command}" != "SEND" and "${bg_color}" != "D3D3D3"    Run Keywords    Set Control Text Value    ${object_name}    ${str_valuetoset}
    ...    ${title_power_express}
    ...    AND    Send    {TAB}
    ...    AND    Verify Control Object Text Value Is Correct    ${object_name}    ${str_valuetoset}
    ...    ELSE IF    "${bg_color}" == "D3D3D3"    Log    Airline Commission Percentage is disabled.    WARN

Select Alternate Fare Class Code
    [Arguments]    ${str_valuetoset}=${EMPTY}    ${command}=SEND
    ${alternate_fare_class_code_dropdown}    Determine Multiple Object Name Based On Active Tab    ccboFareClassOffer_alt
    Control Focus    ${title_power_express}    ${EMPTY}    ${alternate_fare_class_code_dropdown}
    Run Keyword If    "${str_valuetoset}" <> "${EMPTY}"    Select Value From Dropdown List    ${alternate_fare_class_code_dropdown}    ${str_valuetoset}
    Run Keyword If    "${str_valuetoset}" == "${EMPTY}"    Send    {DOWN}
    Run Keyword If    "${str_valuetoset}" == "${EMPTY}"    Send    {ENTER}
    [Teardown]    Take Screenshot

Select Alternate Fully Flex
    ${alternate_fullyflex}    Determine Multiple Object Name Based On Active Tab    cradFullyFlex_alt, cradFullFlexOBT_alt, cradFullyFlex, cradFullyFlex_alt, cradFullFlexOBT
    Click Control Button    ${alternate_fullyflex}

Select Cancellation Dropdown Value
    [Arguments]    ${cancellation_code}    ${fare_tab}=Fare 1    ${field_instance}=${EMPTY}    ${default_control_counter}=True
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ccboCancellationsOBT,ccboCancellations0,ccboCancellationsOBT_alt,ccboCancellations_alt,ccboCancellations_${fare_tab_index},ccboCancellations_alt_${fare_tab_index}    ${default_control_counter}    ${field_instance}
    Select Value From Dropdown List    ${object_name}    ${cancellation_code}

Select Changes Dropdown Value
    [Arguments]    ${changes_code}    ${fare_tab}=Fare 1    ${field_instance}=${EMPTY}    ${default_control_counter}=True
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ccboChangesOBT,ccboChanges0,ccboChangesOBT_alt,ccboChanges_alt,ccboChanges_${fare_tab_index},ccboChanges_alt_${fare_tab_index}    ${default_control_counter}    ${field_instance}
    Select Value From Dropdown List    ${object_name}    ${changes_code}

Select Class Code Value
    [Arguments]    ${class_code}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ccboClass
    Select Value From Dropdown List    ${object_name}    ${class_code}

Select Fare Restriction
    [Arguments]    ${fare_restriction}
    ${object_name}    Run Keyword If    "${fare_restriction.upper()}" == "FULLY FLEXIBLE" or "${fare_restriction}" == "1"    Determine Multiple Object Name Based On Active Tab    cradFullyFlex,cradFullFlex,cradFullyFlexOBT,cradFullFlexOBT,cradFullFlexOBT_alt,cradFullyFlexOBT_alt, cradFullFlex_alt,cradFullyFlex_alt
    ...    ELSE IF    "${fare_restriction.upper()}" == "SEMI FLEXIBLE" or "${fare_restriction}" == "2"    Determine Multiple Object Name Based On Active Tab    cradSemiFlex_alt, cradSemiFlexOBT_alt, cradSemiFlex, cradSemiFlex_alt, cradSemiFlexOBT
    ...    ELSE IF    "${fare_restriction.upper()}" == "NON FLEXIBLE" or "${fare_restriction}" == "3"    Determine Multiple Object Name Based On Active Tab    cradNonFlex_alt, cradNonFlexOBT_alt, cradNonFlex, cradNonFlex_alt, cradNonFlexOBT
    ...    ELSE IF    "${fare_restriction.upper()}" == "DEFAULT"    Determine Multiple Object Name Based On Active Tab    cradDefault,cradDefaultOBT,cradDefault_alt,cradDefaultOBT_alt
    ...    ELSE    Run Keyword And Continue On Failure    Fail    Invalid Fare Restriction: ${fare_restriction}
    Run Keyword If    "${object_name}" != "${EMPTY}" and "${fare_restriction}" != "${EMPTY}"    Click Control Button    ${object_name}

Select Fare Type
    [Arguments]    ${str_valuetoset}    ${command}=SEND
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ccboFaretype
    Select Value From Dropdown List    ${object_name}    ${str_valuetoset}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword And Continue On Failure    Should Be True    "${value}" == "${str_valuetoset}"    ${object_name} should be successfully set to ${str_valuetoset}

Select Fully Flexible
    ${fully_flex_control}    Determine Multiple Object Name Based On Active Tab    cradFullyFlex,cradFullFlex,cradFullyFlexOBT,cradFullFlexOBT,cradFullFlexOBT_alt,cradFullyFlexOBT_alt, cradFullFlex_alt,cradFullyFlex_alt
    Click Control Button    ${fully_flex_control}

Select Max Stay Dropdown Value
    [Arguments]    ${max_stay_value}
    ${max_stay_dropdown}    Determine Multiple Object Name Based On Active Tab    ccboMaxStay, ccboMaxStayOBT, ccboMaxStayOBT_alt, ccboMaxStay_alt
    Select Value From Dropdown List    ${max_stay_dropdown}    ${max_stay_value}

Select Min Stay Dropdown Value
    [Arguments]    ${min_stay_value}
    ${min_stay_dropdown}    Determine Multiple Object Name Based On Active Tab    ccboMinStay, ccboMinStayOBT, ccboMinStayOBT_alt, ccboMinStay_alt
    Select Value From Dropdown List    ${min_stay_dropdown}    ${min_stay_value}

Select Missed Saving Code Value
    [Arguments]    ${missed_saving}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ccboMissed
    Select Value From Dropdown List    ${object_name}    ${missed_saving}

Select Non Flexible
    ${non_flex_control}    Determine Multiple Object Name Based On Active Tab    cradNonFlex_alt, cradNonFlexOBT_alt, cradNonFlex, cradNonFlex_alt, cradNonFlexOBT
    Click Control Button    ${non_flex_control}

Select Re-Route Dropdown Value
    [Arguments]    ${re_route_value}
    ${re_route_dropdown}    Determine Multiple Object Name Based On Active Tab    ccboReRoute, ccboReRouteOBT, ccboReRouteOBT_alt, ccboReRoute_alt
    Select Value From Dropdown List    ${re_route_dropdown}    ${re_route_value}

Select Realised Saving Code Value
    [Arguments]    ${realised_saving}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ccboRealised
    Select Value From Dropdown List    ${object_name}    ${realised_saving}

Select Route Code Value
    [Arguments]    ${route_code}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    cbRouteGeographyCode
    Select Value From Dropdown List    ${object_name}    ${route_code}

Select Semi Flexible
    ${object_name}    Determine Multiple Object Name Based On Active Tab    cradSemiFlex_alt, cradSemiFlexOBT_alt, cradSemiFlex, cradSemiFlex_alt, cradSemiFlexOBT
    Click Control Button    ${object_name}

Select Transaction Fee
    [Arguments]    ${str_valuetoset}    ${command}=SEND
    Log    Setting ${str_valuetoset} in the Transaction Fee Field.
    Sleep    1
    ${object_name}    Determine Multiple Object Name Based On Active Tab    cmbTransactionFee
    Run Keyword If    "${command}" == "SEND"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Set Control Text Value    ${object_name}    ${EMPTY}    ${title_power_express}
    ...    AND    Send    ${str_valuetoset}
    ...    ELSE IF    "${command}" == "DEL"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Send    {DELETE}
    ...    ELSE IF    "${command}" == "SELECT"    Run Keywords    Select Value From Dropdown List    ${object_name}    ${str_valuetoset}
    ...    AND    Send    {TAB}
    ...    ELSE    Set Control Text Value    ${object_name}    ${str_valuetoset}    ${title_power_express}
    Send    {TAB}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword And Continue On Failure    Should Be True    "${value}" == "${str_valuetoset}"    ${object_name} should be successfully set to ${str_valuetoset}

Select Turnaround
    [Arguments]    ${turnaround}=${EMPTY}
    ${turnaround_dropdown}    Determine Multiple Object Name Based On Active Tab    ccboPOT
    ${isVisible}    Control Command    ${title_power_express}    ${EMPTY}    ${turnaround_dropdown}    IsVisible    ${EMPTY}
    Run Keyword If    "${turnaround}" != "${EMPTY}"    Select Value From Dropdown List    ${turnaround_dropdown}    ${turnaround}
    ${default_value}    Run Keyword If    "${turnaround}" == "${EMPTY}"    Control Get Text    ${title_power_express}    ${EMPTY}    ${turnaround_dropdown}
    Run Keyword If    "${turnaround}" == "${EMPTY}" and "${default_value}" == "${EMPTY}" and ${isVisible} == 1    Control Click    ${title_power_express}    ${EMPTY}    ${turnaround_dropdown}
    Run Keyword If    "${turnaround}" == "${EMPTY}" and "${default_value}" == "${EMPTY}" and ${isVisible} == 1    Send    {DOWN}{ENTER}

Select Valid On
    [Arguments]    ${valid_on}=${EMPTY}
    ${valid_on_obj}    Determine Multiple Object Name Based On Active Tab    ccboValidOnOBT, ccboValidOnOBT_alt, ccboValidOn_alt, ccboValidOn
    ${actual_valid_on}    Get Control Text Value    ${valid_on_obj}
    Run Keyword If    "${valid_on}" != "${EMPTY}"    Select Value From Dropdown List    ${valid_on_obj}    ${valid_on}
    Run Keyword If    "${valid_on}" == "${EMPTY}"    Run Keywords    Click Control Button    ${valid_on_obj}
    ...    AND    Send    {DOWN}{ENTER}

Select Valid On Dropdown Value
    [Arguments]    ${valid_on_value}=default
    ${valid_on_dropdown}    Determine Multiple Object Name Based On Active Tab    ccboValidOnOBT, ccboValidOnOBT_alt, ccboValidOn_alt, ccboValidOn
    Run Keyword If    "${valid_on_value}" != "default"    Select Value From Dropdown List    ${valid_on_dropdown}    ${valid_on_value}
    ...    ELSE    Run Keywords    Control Focus    ${title_power_express}    ${EMPTY}    ${valid_on_dropdown}
    ...    AND    Send    {DOWN}
    ...    AND    Sleep    0.5
    ...    AND    Send    {TAB}

Set Alternate Fare Airline
    [Arguments]    ${airline}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtAirlineOffer_alt
    Set Control Text Value    ${object_name}    ${airline}

Set Alternate Fare Amount
    [Arguments]    ${total_fare}    ${command}=SEND
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtTotalFareOffer_alt
    Run Keyword If    "${command}" == "SEND"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Set Control Text Value    ${object_name}    ${EMPTY}    ${title_power_express}
    ...    AND    Send    ${total_fare}
    ...    ELSE    Set Control Text Value    ${object_name}    ${total_fare}    ${title_power_express}
    Send    {TAB}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword If    "${value}" == "${total_fare}"    Log    ${object_name} is successfully set to ${total_fare}
    ...    ELSE    Run keyword and Continue On Failure    FAIL    ${object_name} is NOT successfully set to ${total_fare}
    [Teardown]    Take Screenshot

Set Alternate Fare Details
    [Arguments]    ${details}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtDetailsOffer_alt
    Set Control Text Value    ${object_name}    ${details}

Set Alternate Fare Details With New Line Details
    [Arguments]    ${added_text}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtDetailsOffer_alt
    Click Control Button    ${object_name}
    Send    {END}{ENTER}
    Send    ${added_text}
    Send    {ENTER}
    Sleep    1
    Send    {TAB}
    [Teardown]    Take Screenshot

Set Alternate Fare Fare Basis
    [Arguments]    ${fare_basis}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtFareBasisOffer_alt, ctxtFareBasisOffer_alt
    Control Click    ${title_power_express}    ${EMPTY}    ${object_name}
    Control Set Text    ${title_power_express}    ${EMPTY}    ${object_name}    ${fare_basis}
    [Teardown]    Take Screenshot

Set Alternate Fare Fuel Surcharge
    [Arguments]    ${fuel_surcharge}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtFuelSurchargeOffer_alt
    Set Control Text Value    ${object_name}    ${fuel_surcharge}

Set Alternate Fare Merchant Fee
    [Arguments]    ${merchant_fee}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtMerchantFeeOffer_alt
    Set Control Text Value    ${object_name}    ${merchant_fee}

Set Alternate Fare Routing
    [Arguments]    ${routing}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    cmtxtRouting_alt
    Click Control Button    ${object_name}    ${title_power_express}
    Set Control Text Value    ${object_name}    ${EMPTY}
    Send    ${routing}

Set Alternate Fare Transaction Fee
    [Arguments]    ${transaction_fee}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtTransactionFeeOffer_alt
    Set Control Text Value    ${object_name}    ${transaction_fee}

Set Cancellation Value
    [Arguments]    ${cancellation_code}    ${fare_tab}=Fare 1    ${field_instance}=${EMPTY}    ${default_control_counter}=True
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ccboCancellationsOBT,ccboCancellations0,ccboCancellationsOBT_alt,ccboCancellations_alt,ccboCancellations_${fare_tab_index},ccboCancellations_alt_${fare_tab_index}    ${default_control_counter}    ${field_instance}
    Set Control Text Value    ${object_name}    ${cancellation_code}
    Send    {TAB}

Set Changes Value
    [Arguments]    ${changes_code}    ${fare_tab}=Fare 1    ${field_instance}=${EMPTY}    ${default_control_counter}=True
    ${fare_tab_index}    Fetch From Right    ${fare_tab}    ${SPACE}
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ccboChangesOBT,ccboChanges0,ccboChangesOBT_alt,ccboChanges_alt,ccboChanges_${fare_tab_index},ccboChanges_alt_${fare_tab_index}    ${default_control_counter}    ${field_instance}
    Set Control Text Value    ${object_name}    ${changes_code}
    Send    {TAB}

Set Charged Fare Field
    [Arguments]    ${charged_fare_value}
    ${charged_fare_field}    Determine Multiple Object Name Based On Active Tab    ctxtChargedFare
    Set Control Text Value    ${charged_fare_field}    ${charged_fare_value}
    [Teardown]    Take Screenshot

Set Commission Rebate Amount
    [Arguments]    ${commission_rebate_amount}    ${command}=SEND
    ${object_name}    Determine Multiple Object Name Based On Active Tab    txtClientCommissionRebateAmount
    Run Keyword If    "${command}" == "SEND"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Set Control Text Value    ${object_name}    ${EMPTY}    ${title_power_express}
    ...    AND    Send    ${commission_rebate_amount}
    ...    ELSE    Set Control Text Value    ${object_name}    ${commission_rebate_amount}    ${title_power_express}
    Send    {TAB}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword And Continue On Failure    Should Be True    "${value}" == "${commission_rebate_amount}"    ${object_name} should be successfully set to ${commission_rebate_amount}
    [Teardown]    Take Screenshot

Set Commission Rebate Percentage
    [Arguments]    ${str_valuetoset}    ${command}=SEND
    ${object_name}    Determine Multiple Object Name Based On Active Tab    txtClientCommissionRebatePercentage
    Run Keyword If    "${command}" == "SEND"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Set Control Text Value    ${object_name}    ${EMPTY}    ${title_power_express}
    ...    AND    Send    ${str_valuetoset}
    ...    ELSE    Set Control Text Value    ${object_name}    ${str_valuetoset}    ${title_power_express}
    Send    {TAB}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword And Continue On Failure    Should Be True    "${value}" == "${str_valuetoset}"    ${object_name} should be successfully set to ${str_valuetoset}
    [Teardown]    Take Screenshot

Set Fees Field
    [Arguments]    ${fees_value}
    ${fees_field}    Determine Multiple Object Name Based On Active Tab    ctxtFees
    ${current_fees_value}    Set Control Text Value    ${fees_field}    ${fees_value}
    Take Screenshot

Set Fees Field (If Zero)
    [Arguments]    ${fees_value}
    ${fees_field}    Determine Multiple Object Name Based On Active Tab    ctxtFees
    ${current_fees_value}    Get Control Text Value    ${fees_field}
    Run Keyword If    "${current_fees_value}" == "${EMPTY}" or "${current_fees_value}" == "0.00" or "${current_fees_value}" == "0.0" or "${current_fees_value}" == "0"    Set Control Text Value    ${fees_field}    ${fees_value}
    Take Screenshot

Set Fuel Surcharge Field
    [Arguments]    ${str_valuetoset}    ${command}=SEND
    Activate Power Express Window
    ${object_name}    Determine Multiple Object Name Based On Active Tab    txtFuelSurcharge
    Run Keyword If    "${command}" == "SEND"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Set Control Text Value    ${object_name}    ${EMPTY}    ${title_power_express}
    ...    AND    Send    ${str_valuetoset}
    ...    ELSE    Set Control Text Value    ${object_name}    ${str_valuetoset}    ${title_power_express}
    Send    {TAB}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword And Continue On Failure    Should Be True    "${value}" == "${str_valuetoset}"    ${object_name} should be successfully set to ${str_valuetoset}
    [Teardown]    Take Screenshot

Set High Fare Field
    [Arguments]    ${high_fare_value}
    ${high_fare_field}    Determine Multiple Object Name Based On Active Tab    ctxtHighFare
    Send Control Text Value    ${high_fare_field}    ${high_fare_value}
    Send    {TAB}
    [Teardown]    Take Screenshot

Set High Fare Field (If blank) with Charged Fare
    ${charged_fare_field}    Determine Multiple Object Name Based On Active Tab    ctxtChargedFare
    ${high_fare_field}    Determine Multiple Object Name Based On Active Tab    ctxtHighFare
    ${charged_fare}    Get Control Text Value    ${charged_fare_field}
    ${high_fare}    Get Control Text Value    ${high_fare_field}
    ${converted_charged_fare}    Replace String    ${charged_fare}    ,    .
    ${converted_high_fare}    Replace String    ${high_fare}    ,    .
    Run Keyword If    '${high_fare}' == '${EMPTY}'    Set Control Text Value    ${high_fare_field}    ${charged_fare}
    ...    ELSE IF    ${converted_high_fare} < ${converted_charged_fare}    Set Control Text Value    ${high_fare_field}    ${charged_fare}

Set High Fare Field With Charged Fare
    ${charged_fare_field}    Determine Multiple Object Name Based On Active Tab    ctxtChargedFare
    ${charged_fare}    Get Control Text Value    ${charged_fare_field}
    Set High Fare Field    ${charged_fare}

Set LFCC Field
    [Arguments]    ${str_valuetoset}=QF    ${command}=SEND
    Log    Setting ${str_valuetoset} in the LFCC textbox.
    Sleep    1
    ${object_name}    Determine Multiple Object Name Based On Active Tab    ctxtLowestFareCC
    Run Keyword If    "${command}" == "SEND"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Set Control Text Value    ${object_name}    ${EMPTY}    ${title_power_express}
    ...    AND    Send    ${str_valuetoset}
    ...    ELSE    Set Control Text Value    ${object_name}    ${str_valuetoset}    ${title_power_express}
    Send    {TAB}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword And Continue On Failure    Should Be True    "${value}" == "${str_valuetoset}"    ${object_name} should be successfully set to ${str_valuetoset}
    [Teardown]    Take Screenshot

Set Low Fare Field
    [Arguments]    ${low_fare_value}
    ${low_fare_field}    Determine Multiple Object Name Based On Active Tab    ctxtLowFare
    Send Control Text Value    ${low_fare_field}    ${low_fare_value}
    Send    {TAB}
    [Teardown]    Take Screenshot

Set Low Fare Field (If blank) with Charged Fare
    ${charged_fare_field}    Determine Multiple Object Name Based On Active Tab    ctxtChargedFare
    ${low_fare_field}    Determine Multiple Object Name Based On Active Tab    ctxtLowFare
    ${charged_fare}    Get Control Text Value    ${charged_fare_field}
    ${low_fare}    Get Control Text Value    ${low_fare_field}
    ${converted_charged_fare}    Replace String    ${charged_fare}    ,    .
    ${converted_low_fare}    Replace String    ${low_fare}    ,    .
    Run Keyword If    '${low_fare}' == '${EMPTY}'    Set Control Text Value    ${low_fare_field}    ${charged_fare}
    ...    ELSE IF    ${converted_low_fare} > ${converted_charged_fare}    Set Control Text Value    ${low_fare_field}    ${charged_fare}
    [Teardown]    Take Screenshot

Set Low Fare Field With Charged Fare
    ${charged_fare_field}    Determine Multiple Object Name Based On Active Tab    ctxtChargedFare
    ${charged_fare}    Get Control Text Value    ${charged_fare_field}
    Set Low Fare Field    ${charged_fare}

Set Mark-Up Amount Field
    [Arguments]    ${mark_up_amount}    ${command}=SEND
    ${object_name}    Determine Multiple Object Name Based On Active Tab    txtMarkupAmount
    Run Keyword If    "${command}" == "SEND"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Set Control Text Value    ${object_name}    ${EMPTY}    ${title_power_express}
    ...    AND    Send    ${mark_up_amount}
    ...    ELSE    Set Control Text Value    ${object_name}    ${mark_up_amount}    ${title_power_express}
    Send    {TAB}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword And Continue On Failure    Should Be True    "${value}" == "${mark_up_amount}"    ${object_name} should be successfully set to ${mark_up_amount}
    [Teardown]    Take Screenshot

Set Mark-up Percentage Field
    [Arguments]    ${str_valuetoset}    ${command}=SEND
    ${object_name}    Determine Multiple Object Name Based On Active Tab    txtMarkupPercentage
    Run Keyword If    "${command}" == "SEND"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Send    {CTRLDOWN}A{CTRLUP}
    ...    AND    Sleep    1
    ...    AND    Send    {BACKSPACE}
    ...    AND    Send    ${str_valuetoset}
    ...    ELSE    Set Control Text Value    ${object_name}    ${str_valuetoset}    ${title_power_express}
    Send    {TAB}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword And Continue On Failure    Should Be True    "${value}" == "${str_valuetoset}"    ${object_name} should be successfully set to ${str_valuetoset}

Set Merchant Fee Amount
    [Arguments]    ${str_valuetoset}    ${command}=SEND
    ${object_name}    Determine Multiple Object Name Based On Active Tab    txtMerchantFeeAmount
    Run Keyword If    "${command}" == "SEND"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Set Control Text Value    ${object_name}    ${EMPTY}    ${title_power_express}
    ...    AND    Send    ${str_valuetoset}
    ...    ELSE    Set Control Text Value    ${object_name}    ${str_valuetoset}    ${title_power_express}
    Send    {TAB}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword And Continue On Failure    Should Be True    "${value}" == "${str_valuetoset}"    ${object_name} should be successfully set to ${str_valuetoset}

Set Merchant Fee Percentage Field
    [Arguments]    ${str_valuetoset}    ${command}=SEND
    ${object_name}    Determine Multiple Object Name Based On Active Tab    txtMerchantFeePercentage
    Run Keyword If    "${command}" == "SEND"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Send    {CTRLDOWN}A{CTRLUP}
    ...    AND    Sleep    1
    ...    AND    Send    {BACKSPACE}
    ...    AND    Send    ${str_valuetoset}
    ...    ELSE    Set Control Text Value    ${object_name}    ${str_valuetoset}    ${title_power_express}
    Send    {TAB}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword And Continue On Failure    Should Be True    "${value}" == "${str_valuetoset}"    ${object_name} should be successfully set to ${str_valuetoset}

Set Nett Fare Field
    [Arguments]    ${str_valuetoset}    ${command}=SEND
    ${object_name}    Determine Multiple Object Name Based On Active Tab    txtNettFareAmount
    Run Keyword If    "${command}" == "SEND"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Send    {CTRLDOWN}A{CTRLUP}
    ...    AND    Sleep    1
    ...    AND    Send    {BACKSPACE}
    ...    AND    Send    ${str_valuetoset}
    ...    ELSE IF    "${str_valuetoset}" == "${EMPTY}"    Run Keywords    Click Control Button    ${object_name}    ${title_power_express}
    ...    AND    Send    {CTRLDOWN}A{CTRLUP}
    ...    AND    Sleep    1
    ...    AND    Send    {BACKSPACE}
    ...    ELSE    Set Control Text Value    ${object_name}    ${str_valuetoset}    ${title_power_express}
    Send    {TAB}
    ${value}    Get Control Text Value    ${object_name}    ${title_power_express}
    Run Keyword And Continue On Failure    Should Be True    "${value}" == "${str_valuetoset}"    ${object_name} should be successfully set to ${str_valuetoset}

Tick Fare Not Finalised
    Click Fare Tab    Fare 1
    Tick Checkbox    ${chk_not_finalised}

Untick Fare Not Finalised
    Click Fare Tab    Fare 1
    Untick Checkbox    ${chk_not_finalised}
